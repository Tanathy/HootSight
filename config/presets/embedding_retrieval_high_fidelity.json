{
    "name": "presets.embedding_retrieval_high_fidelity.name",
    "description": "presets.embedding_retrieval_high_fidelity.description",
    "task": "classification",
    "categories": ["embedding", "finegrained", "high-fidelity"],
    "dataset_types": [
        "folder_classification",
        "multi_label"
    ],
    "recommended_models": [
        "efficientnet",
        "resnext",
        "resnet"
    ],
    "configs": {
        "tiny": {
            "description": "presets.configs.tiny",
            "range": [50, 500],
            "config": {
                "training": {
                    "task": "classification",
                    "model_type": "efficientnet",
                    "model_name": "efficientnet_b2",
                    "pretrained": true,
                    "input_size": 288,
                    "batch_size": 8,
                    "epochs": 160,
                    "learning_rate": 4e-05,
                    "weight_decay": 0.02,
                    "val_ratio": 0.25,
                    "normalize": {
                        "mean": [0.485, 0.456, 0.406],
                        "std": [0.229, 0.224, 0.225]
                    },
                    "dataloader": {
                        "num_workers": 0,
                        "pin_memory": true,
                        "persistent_workers": false,
                        "prefetch_factor": 2
                    },
                    "augmentation": {
                        "train": [],
                        "val": []
                    },
                    "loss_type": "cross_entropy",
                    "loss_reduction": "mean",
                    "optimizer_type": "adamw",
                    "optimizer_lr": 4e-05,
                    "optimizer_weight_decay": 0.02,
                    "scheduler_type": "cosine_annealing_lr",
                    "scheduler_params": {
                        "cosine_annealing_lr": {
                            "T_max": 160,
                            "eta_min": 1e-07
                        }
                    },
                    "early_stopping": {
                        "enabled": true,
                        "patience": 28,
                        "min_delta": 0.001,
                        "monitor": "val_loss"
                    },
                    "gradient": {
                        "clip_norm": 1.0,
                        "clip_value": null,
                        "accumulation_steps": 2
                    },
                    "runtime": {
                        "mixed_precision": true,
                        "channels_last": true,
                        "allow_tf32": true,
                        "cudnn_benchmark": true
                    }
                }
            }
        },
        "small": {
            "description": "presets.configs.small",
            "range": [500, 2500],
            "config": {
                "training": {
                    "task": "classification",
                    "model_type": "efficientnet",
                    "model_name": "efficientnet_b3",
                    "pretrained": true,
                    "input_size": 320,
                    "batch_size": 12,
                    "epochs": 120,
                    "learning_rate": 8e-05,
                    "weight_decay": 0.01,
                    "val_ratio": 0.2,
                    "normalize": {
                        "mean": [0.485, 0.456, 0.406],
                        "std": [0.229, 0.224, 0.225]
                    },
                    "dataloader": {
                        "num_workers": 0,
                        "pin_memory": true,
                        "persistent_workers": false,
                        "prefetch_factor": 2
                    },
                    "augmentation": {
                        "train": [],
                        "val": []
                    },
                    "loss_type": "cross_entropy",
                    "loss_reduction": "mean",
                    "optimizer_type": "adamw",
                    "optimizer_lr": 8e-05,
                    "optimizer_weight_decay": 0.01,
                    "scheduler_type": "cosine_annealing_lr",
                    "scheduler_params": {
                        "cosine_annealing_lr": {
                            "T_max": 120,
                            "eta_min": 1e-07
                        }
                    },
                    "early_stopping": {
                        "enabled": true,
                        "patience": 22,
                        "min_delta": 0.001,
                        "monitor": "val_loss"
                    },
                    "gradient": {
                        "clip_norm": 1.0,
                        "clip_value": null,
                        "accumulation_steps": 1
                    },
                    "runtime": {
                        "mixed_precision": true,
                        "channels_last": true,
                        "allow_tf32": true,
                        "cudnn_benchmark": true
                    }
                }
            }
        },
        "medium": {
            "description": "presets.configs.medium",
            "range": [2500, 10000],
            "config": {
                "training": {
                    "task": "classification",
                    "model_type": "efficientnet",
                    "model_name": "efficientnet_b4",
                    "pretrained": true,
                    "input_size": 380,
                    "batch_size": 16,
                    "epochs": 90,
                    "learning_rate": 0.0002,
                    "weight_decay": 0.001,
                    "val_ratio": 0.15,
                    "normalize": {
                        "mean": [0.485, 0.456, 0.406],
                        "std": [0.229, 0.224, 0.225]
                    },
                    "dataloader": {
                        "num_workers": 2,
                        "pin_memory": true,
                        "persistent_workers": true,
                        "prefetch_factor": 2
                    },
                    "augmentation": {
                        "train": [],
                        "val": []
                    },
                    "loss_type": "cross_entropy",
                    "loss_reduction": "mean",
                    "optimizer_type": "adamw",
                    "optimizer_lr": 0.0002,
                    "optimizer_weight_decay": 0.001,
                    "scheduler_type": "cosine_annealing_lr",
                    "scheduler_params": {
                        "cosine_annealing_lr": {
                            "T_max": 90,
                            "eta_min": 1e-07
                        }
                    },
                    "early_stopping": {
                        "enabled": true,
                        "patience": 16,
                        "min_delta": 0.001,
                        "monitor": "val_loss"
                    },
                    "gradient": {
                        "clip_norm": null,
                        "clip_value": null,
                        "accumulation_steps": 1
                    },
                    "runtime": {
                        "mixed_precision": true,
                        "channels_last": true,
                        "allow_tf32": true,
                        "cudnn_benchmark": true
                    }
                }
            }
        },
        "large": {
            "description": "presets.configs.large",
            "range": [10000, 30000],
            "config": {
                "training": {
                    "task": "classification",
                    "model_type": "efficientnet",
                    "model_name": "efficientnet_b4",
                    "pretrained": true,
                    "input_size": 380,
                    "batch_size": 24,
                    "epochs": 70,
                    "learning_rate": 0.0005,
                    "weight_decay": 0.0005,
                    "val_ratio": 0.15,
                    "normalize": {
                        "mean": [0.485, 0.456, 0.406],
                        "std": [0.229, 0.224, 0.225]
                    },
                    "dataloader": {
                        "num_workers": 4,
                        "pin_memory": true,
                        "persistent_workers": true,
                        "prefetch_factor": 2
                    },
                    "augmentation": {
                        "train": [],
                        "val": []
                    },
                    "loss_type": "cross_entropy",
                    "loss_reduction": "mean",
                    "optimizer_type": "adamw",
                    "optimizer_lr": 0.0005,
                    "optimizer_weight_decay": 0.0005,
                    "scheduler_type": "cosine_annealing_lr",
                    "scheduler_params": {
                        "cosine_annealing_lr": {
                            "T_max": 70,
                            "eta_min": 1e-07
                        }
                    },
                    "early_stopping": {
                        "enabled": true,
                        "patience": 12,
                        "min_delta": 0.001,
                        "monitor": "val_loss"
                    },
                    "gradient": {
                        "clip_norm": null,
                        "clip_value": null,
                        "accumulation_steps": 1
                    },
                    "runtime": {
                        "mixed_precision": true,
                        "channels_last": true,
                        "allow_tf32": true,
                        "cudnn_benchmark": true
                    }
                }
            }
        },
        "huge": {
            "description": "presets.configs.huge",
            "range": [30000, 50000],
            "config": {
                "training": {
                    "task": "classification",
                    "model_type": "efficientnet",
                    "model_name": "efficientnet_b5",
                    "pretrained": true,
                    "input_size": 456,
                    "batch_size": 20,
                    "epochs": 60,
                    "learning_rate": 0.0007,
                    "weight_decay": 0.0003,
                    "val_ratio": 0.1,
                    "normalize": {
                        "mean": [0.485, 0.456, 0.406],
                        "std": [0.229, 0.224, 0.225]
                    },
                    "dataloader": {
                        "num_workers": 4,
                        "pin_memory": true,
                        "persistent_workers": true,
                        "prefetch_factor": 2
                    },
                    "augmentation": {
                        "train": [],
                        "val": []
                    },
                    "loss_type": "cross_entropy",
                    "loss_reduction": "mean",
                    "optimizer_type": "adamw",
                    "optimizer_lr": 0.0007,
                    "optimizer_weight_decay": 0.0003,
                    "scheduler_type": "cosine_annealing_lr",
                    "scheduler_params": {
                        "cosine_annealing_lr": {
                            "T_max": 60,
                            "eta_min": 1e-07
                        }
                    },
                    "early_stopping": {
                        "enabled": true,
                        "patience": 10,
                        "min_delta": 0.001,
                        "monitor": "val_loss"
                    },
                    "gradient": {
                        "clip_norm": null,
                        "clip_value": null,
                        "accumulation_steps": 1
                    },
                    "runtime": {
                        "mixed_precision": true,
                        "channels_last": true,
                        "allow_tf32": true,
                        "cudnn_benchmark": true
                    }
                }
            }
        },
        "massive": {
            "description": "presets.configs.massive",
            "range": [50000, 100000],
            "config": {
                "training": {
                    "task": "classification",
                    "model_type": "efficientnet",
                    "model_name": "efficientnet_b5",
                    "pretrained": true,
                    "input_size": 456,
                    "batch_size": 24,
                    "epochs": 45,
                    "learning_rate": 0.001,
                    "weight_decay": 0.0002,
                    "val_ratio": 0.1,
                    "normalize": {
                        "mean": [0.485, 0.456, 0.406],
                        "std": [0.229, 0.224, 0.225]
                    },
                    "dataloader": {
                        "num_workers": 4,
                        "pin_memory": true,
                        "persistent_workers": true,
                        "prefetch_factor": 2
                    },
                    "augmentation": {
                        "train": [],
                        "val": []
                    },
                    "loss_type": "cross_entropy",
                    "loss_reduction": "mean",
                    "optimizer_type": "adamw",
                    "optimizer_lr": 0.001,
                    "optimizer_weight_decay": 0.0002,
                    "scheduler_type": "cosine_annealing_lr",
                    "scheduler_params": {
                        "cosine_annealing_lr": {
                            "T_max": 45,
                            "eta_min": 1e-07
                        }
                    },
                    "early_stopping": {
                        "enabled": true,
                        "patience": 9,
                        "min_delta": 0.001,
                        "monitor": "val_loss"
                    },
                    "gradient": {
                        "clip_norm": null,
                        "clip_value": null,
                        "accumulation_steps": 1
                    },
                    "runtime": {
                        "mixed_precision": true,
                        "channels_last": true,
                        "allow_tf32": true,
                        "cudnn_benchmark": true
                    }
                }
            }
        },
        "giant": {
            "description": "presets.configs.giant",
            "range": [100000, null],
            "config": {
                "training": {
                    "task": "classification",
                    "model_type": "efficientnet",
                    "model_name": "efficientnet_b6",
                    "pretrained": true,
                    "input_size": 528,
                    "batch_size": 24,
                    "epochs": 35,
                    "learning_rate": 0.0012,
                    "weight_decay": 0.0001,
                    "val_ratio": 0.05,
                    "normalize": {
                        "mean": [0.485, 0.456, 0.406],
                        "std": [0.229, 0.224, 0.225]
                    },
                    "dataloader": {
                        "num_workers": 4,
                        "pin_memory": true,
                        "persistent_workers": true,
                        "prefetch_factor": 2
                    },
                    "augmentation": {
                        "train": [],
                        "val": []
                    },
                    "loss_type": "cross_entropy",
                    "loss_reduction": "mean",
                    "optimizer_type": "adamw",
                    "optimizer_lr": 0.0012,
                    "optimizer_weight_decay": 0.0001,
                    "scheduler_type": "cosine_annealing_lr",
                    "scheduler_params": {
                        "cosine_annealing_lr": {
                            "T_max": 35,
                            "eta_min": 1e-07
                        }
                    },
                    "early_stopping": {
                        "enabled": true,
                        "patience": 7,
                        "min_delta": 0.001,
                        "monitor": "val_loss"
                    },
                    "gradient": {
                        "clip_norm": null,
                        "clip_value": null,
                        "accumulation_steps": 1
                    },
                    "runtime": {
                        "mixed_precision": true,
                        "channels_last": true,
                        "allow_tf32": true,
                        "cudnn_benchmark": true
                    }
                }
            }
        }
    }
}
